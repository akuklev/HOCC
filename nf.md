Годовщине изгнания из рая посвещается
=====================================

Несколько месяцев назад завершилась математическая одиссея длинной в 140 лет.

В 1884 году в работе «Die Grundlagen der Arithmetik» («Обоснования арифметики») великий логик Готтлоб Фреге предположил, что
арифметика эмергентна: натуральные числа и арифметические операции естественным образом возникают в рамках формальной системы
математической логики, а законы арифметики “неизбежны” и выводимы безо всякой отсылки к реальным или гипотетическим сущностям
и тем более эмпирическим наблюдениям.

Без малого двадцать лет он работал над формальной системой математической логики, решающей эту задачу. Предложенная им в итоге
система не только решала эту задачу — она как будто могла служить общей базой для всей математики! Она совмещала элегантность,
минимализм и невероятную мощь. Но вдруг всё рухнуло в одночасье — система оказалась противоречивой.

В 1937 философ и математик Уиллард Куайн предложил логическую систему NF (от «New Foundations for Mathematical Logic»), которая
была очень близка по построению к исходной системе Фреге, но избегала известных противоречий. NF оказалась малопригодна на роль
общей базы всей математики, но решала исходную задачу Фреге по обоснованию арифметики через редукцию к чистой логике:
NF — чисто логическая система, в которой эмергентны натуральные числа и операции над ними, NF ⊢ PA (NF содержит арифметику Пеано)[[Tu12](https://cs.ioc.ee/~tarmo/tsem11/tupailo2401-slides.pdf)].
Кроме того, NF является единственной известной логической системой, пригодной для рассуждения об всеобъемлющих автореферрентных
структурах, таких как множество всех множеств (включая себя) или категория всех категорий (включая себя).

Разумеется, сразу возник вопрос о непротиворечивости NF. Целый ряд результатов заставлял усомниться в её непротиворечивости,
а попытки доказать её относительную непротиворечивость десятилетиями оказывались бесплодными. И вот, спустя без малого
90 лет в этом вопросе наконец была поставлена точка: Доказательство непротиворечивости, предложенное Рэндалом Холмсом в 2010,
в апреле было успешно формализовано и верифицировано в [Lean](https://lean-lang.org/).

Доказательство непротиворечивости NF — отличный повод поговорить подробнее о том, что такое теория множеств, какое отношение
она имеет к основаниям математики, причём тут логический редукционизм и какова современная точка зрения на эти вопросы.

# Аксиоматические теории, исчисление предикатов и наивная теория множеств

Около 300 года до н.э. греческий философ и математик Евклид Александрийский написал монографию «Начала» (Στοιχεῖα), где он
демонстрирует на огромном количестве примеров, что всевозможные свойства геометрических фигур, выводимы при помощи законов
логики из небольшого набора постулатов (“аксиом”). Так родилось понятие аксиоматической теории.

Прежде чем записывать постулаты, нужно перечислить специфичные для данной теории понятия: разновидности упоминающихся в
постулатах сущностей (точки, линии и длины) и отношения между сущностями (параллельность линий, принадлежность точки
линии, ...). Такой “словарик понятий, принятых в качестве базовых” называется сигнатурой теории. Язык, на котором
записываются постулаты и другие утверждения теории, образуется понятиями теории (сигнатурой) и общелогической базой:
кванторами, логическими связками, отношением равенства. Вот эта общая часть языков всех аксиоматических теорий называется
**исчислением предикатов**.

Кроме эвклидовой геометрии имеются сотни других важных аксиоматических теорий, начиная с арифметики, вещественного анализа,
и т.д. Однако, все математические области взаимосвязаны, и чтобы заниматься математикой в комплексе нужна какая-то общая база,
“аксиоматическая теория математических кирпичей”, в которую отображаются отдельные аксиоматические теории вроде геометрии Евклида
и арифметики Пеано.

В конце XIX века Готтлоб Фреге предложил использовать в этом качестве, в качестве общематематической базы, аксиоматическую теорию,
предметом рассмотрения которой является сами логические предикаты этой теории. Сейчас бы такую теорию могли назвать, например,
«автореферрентным исчислением предикатов», но по историческим причинам за ней закрепилось другое название — «наивная теория множеств».

В отличие от других аксиоматических теорий, таких как геометрия Евклида или арифметика Пеано, теория множеств Фреге не аппелирует ни к
какой внешней предметной области для обоснования своих постулатов: не считая законов логики, её единственным постулатом является принцип
абстракции Фреге:
  **всякое свойство определяет, и притом однозначно, множество всех элементов, обладающих этим свойством.**

Говоря формально, это семейство аксиом: для всякого предиката `φ[x]`, определимого на языке логики предикатов, дополненной бинарным отношением
принадлежности (∈), постулируется `∃!(S) x ∈ S ⇔ φ[x]`.

# Понятие множества в основаниях математики и теоретико-множественный редукционизм


Множества в смысле Фреге это в точности объектификация логических предикатов о самих себе. Совсем не то, что представляешь себе под множеством
в первый момент.

При первом знакомстве, множества обычно изображают как кружочки, содержащие которых буквы, цифры или точки. Их элементы — не другие множества,
а некие “первичные элементы” — абстрактные различимые объекты, лишенные внутренней структуры. Такие множества ещё называются неупорядоченными
наборами без повторений, и являются одним из распространённых типов комбинаторных стуктур наряду с упорядоченными наборами, неупорядоченными
наборами с повторениями и т. д.

Теория множеств, предложенная Фреге, не про них. Не про них и все её идейные наследники — теории множеств, предназначенные для использования
в качестве общей базы математики, “аксиоматической теории математических кирпичей”.

Фреге не ставил перед собой задачу создать аксиоматическую теорию “неупорядоченных наборов без повторений”. Множества как таковые вообще не особенно
интересовали его, он изучал логику и изучая её наткнулся на объекты, напоминающие неупорядоченные наборы без повторений, но только содержащие не
какие-то “первичные элементы” без внутренней структуры, а другие такие же множества. Ведь теория множеств Фреге односортна и everything is a set,
а стало быть все элементы множеств Фреге тоже в свою очередь множества Фреге.

Предмет изучения теории множеств (всех теорий множеств, предназначенных для использования в качестве общематематической базы) — абстрактные вложенные
множества. Но как же вообще быть, если нет никаких “первичных элементов”? На помощь приходит пустое множество ∅ — единственное, которое можно
сконструировать безо всяких первичных элементов. И именно оно служит единственным первичным элементом всех других множеств. Так можно построить
множество {∅} содержащее пустое множество и только его, а также множество {∅, {∅}}, элементами которого являются два приведённых прежде множества.

Выходит, что из пустых множеств можно сконструировать множества любого конечного размера. Вот откуда берёт начало фрегеанская идея редукции
арифметики к логике. Фреге определяет каждое натуральное число n как “множество всех n-элементных (абстрактных вложенных) множеств”, объективизацию
n-элементности. Ему удаётся определить множество всех натуральных чисел, операции сложения и умножения на нём и доказать все аксиомы арифметики
из чистой логики.

Аксиоматические теории могут нуждаться в разновидностях сущностей высшего порядка, например не только “числах”, но и “множествах чисел” или
“функциях на числах”. Теория Фреге, оставаясь односортной аксиоматической теорией, является теорией сколь-угодно высокого порядка, потому что множества
Фреге это одновременно множества множеств Фреге и множества множеств множеств Фреге и так далее. Создавая возможность говорить о любом предикате этой
теории как об объекте этой теории, Фреге конструировал логику сколь угодно высшего порядка. Абстрактные вложенные множества, сделанные out of thin air,
из вакуума пустых множеств, были интересны ему не сами по себе, не как самостоятельные математические объекты, а лишь потому что они взаимно-однозначно
соответствуют логическим предикатам над самими собой. И приятной неожиданностью оказывается, что авторефлексивная кострукция даёт достаточно структуры,
чтобы можно было отображать в неё другие аксиоматические теории: возможность моделлировать натуральные числа и множества натуральных чисел открывает путь
к моделированию практически любых математических сущностей.

Именно поэтому теория множеств Фреге предлагалась в качестве общематематической базы вовсе не потому, что “неупорядоченные наборы без повторений” или тем
более “абстрактные вложенные множества” как-то особенно хороши.

# Изгнание из рая
Это был философски-математический рай. Но очень недолго. До тех пор, пока ровно 122 года назад, 16.06.1902, Бертран Рассел не написал Готтлобу Фреге письмо
относительно монографии Grundgesetze der Arithmetik: “there is just one point where I have encountered a difficulty.”

Если принять принцип Фреге, получается что существует множество {x | x ∉ x} всех множеств, не содержащих самих себя. Но если оно существует, то
принадлежит ли оно само себе? На этот вопрос невозможен ни положительный, ни отрицательный ответ (это назвается парадоксом Рассела), так что не
может такое множество существовать.

Наивная теория множеств оказалась несостоятельной, а математика вошла в глубокий кризис, полностью её перепахавший и веведший на другой уровень.

Этот, оказавшийся недопустимым, принцип абстракции Фреге позже назвали неограниченным принципом абстракции, потому что чтобы избежать противоречий,
его нужно тем или иным способом ограничить чтобы из него не следовало существование паталогических автореферрентных объектов типа {x | x ∉ x}.

# Попытки встать на ноги
Когда нужно что-то ограничить, всегда есть два крайних подхода — знаете, как с пищевыми добавками в США и в Европе. В США разрешено всё кроме
заведомо ядовитого. В ЕС запрещено всё, что не имеет доказанной безвредности.

Обжегшись на неограниченном принципе свёртывания математики начала XX века в основном пошли по второму пути: стали рассматривать только множества,
которые можно построить начиная с пустого множества “снизу вверх”, иерархические множества.

Стандартная теория множеств ZF(C) рассматривает только иерархические множества. Вполне допустимые с точки зрения наивной теории множества, допускающие
бесконечные цепочки a ∋ b ∋ c ∋ ··· такими теориями не рассматриваются в принципе, чтобы не дай бог не напороться на паталогические автореферрентные множества.

(TODO: сказать что они уже не соответствуют взаимно-однозначно предикатам над собой, теряется и красивая аксиоматизация)

Попытка пойти по пути ”запретить только заведомо ядовитое“ — система NF, разработанная в 1937 философом и математиком Уиллардом Куайном. Название происходит от
названия статьи New Foundations for Mathematical Logic, где эта система описывается. Как и наивная теория множеств, эта система состоит из логики предикатов с 
экстенциональным равенством и одной единственной схемой аксиом — принципом абстракции, но уже ограниченным синтаксически: всякое свойство, описуемое
стратифицируемой логической формулой, определяет множество множеств, обладающих этим свойством. Тут стратифицируемость — некое синтаксической свойство
формулы (не буду вдаваться в технические подробности), защищающее от паталогических автореферрентных множеств.

На практике NF оказалась не такой уж удобной штукой, но очень интересной философски.

В частности, количественные числа (кардиналы) там можно определить как завещал Фреге — как классы эквивалентности множеств по взаимно-однозначной сопостовляемости.
В ZF приходится проявлять произвол и выбирать какой-то конкретный (один из нескольких естественных) способов кодирования натуральных чисел множествами, а в NF это
просто кардинал “2” это совокупность всех двухэлементных множеств, и это канонический выбор.

NF — уникальная система оснований математики, допускающая предельные структуры, содержащие сами себя:
- множество всех множеств,
- множеств всех ординалов,
- категорию всех категорий.

Но чтобы математики всерьёз занимались NF, было необходимо было показать её непротиворечивость относительно стаднартной теории множеств. На протяжении более чем
80 лет это ни у кого не получалось. Потом Randall Holmes выложил препринт такого доказательства. Только никто не был готов делать peer review этой статьи.
Сам же автор во введении употребляет фразу ‘insanely involved with nasty bookkeeping’ (безумно насыщено монструозной бухгалтерией) в отношении своего доказательства.
И вот вместо того чтобы ждать пока кто-то снизойдёт до проверки этого монстуруозного доказательства, они с аспирантом Sky Wilshaw взяли и формализовали доказательство, так что его проверил компьютер.
https://www.logicmatters.net/.../21/nf-really-is-consistent/

* * *

В заключение я ещё скажу пару слов про то, почему NF не особенно удобна на практике. Всё дело в том, примерно все практические применения теории множеств
используют не гигантические всеобъемлющие структуры, в как раз-таки иерархические множества. При работе с такими множествами стратифицируемость формул при
использовании принципа абстракции не требуется и очень мешает.

Что мешает — это понятно сразу как попробуешь хоть немного практически поработать в рамках NF, а вот что “не требуется” — этого, конечно, изначально тоже
никто не знал.  В 1956 году Вильгельм Аккерман предложил свой вариант теории множеств (AST), где область рассмотрения не ограничивается только иерархическими
множествами, а принцип абстракци тоже ограничивается по либеральной схеме ”запретить только заведомо ядовитое“, но совсем по-другому чем в NF.

В теории Аккермана постулируется константа V — множество иерархических множеств (само по себе не являющееся иерархическим), а принцип абстракции разбивается на
два аспекта — выделение и рефлексия.

Выделение {x ∈ V | φ(x)} позволяет безо всяких ограничений на предикат φ строить подмножества V, удовлетворяющие этому предикату. Т.е. для любого предиката φ
существует множество иерархических, удовлетворяющих этому предикату.

Рефлексия же постулирует, что всякий предикат, кванторы в котором могут быть ограничены на V без изменения смысла, определяет множество (не обязательно иерархическое):
 φ ⇔ φᵛ
––—––––
{x | φ(x)}

AST является расширением ZF в том смысле, что её язык позволяет говорить не только об иерархических множествах, как ZF, но и о множестве V (всех иерархических множеств)
или Ord (всех иерархических ординалов), более того такие неиерархические множества могут быть элементами других множеств, что выгодно отличает эту теорию от
распостранённой теории NBG.

В 1970 году было показано, что эта теория является эквиконсистентным консервативным расширением ZF:
1) любое утверждение про иерархические множества доказуемо в AST тогда и только тогда, когда оно доказуемо в ZF;
2) из непротиворечивости ZF следует непротиворечивость AST и обратно.

Таким образом выходит что если ограничиваться иерархическими множествами, либеральный и минималистский подход совпадают.

Стоп! Так если в AST уже есть V и Ord, чем вообще хороша NF?! — А тем, что в AST ни V (всех иерархических множеств), ни Ord (всех иерархических ординалов),
не содержат сами себя — они ведь не являются сами иерархическими, избегая таким образом автореферрентности.
В то время как в NF возможны “настоящие” всеобъемлющие структуры.

Вот за этим и нужна NF. Сейчас в 21ом веке едва ли кто-то будет всерьёз рассматривать голую NF в качестве ‘новой, более хорошей общематематической базой’.
Она полезна как самостоятельная теория, чей предмет изучения — автореферрентные предельные структуры, такие как “категория” всех категорий (включая себя),
и её скелет — “множество” всех ординалов, которое само по себе вполне-упорядочено, и таким образом само является ординалом. Ну и конечно же “множество” всех множеств (включая себя) и скелет “категории” всех множеств — “множество” всех кардиналов (мощностей множеств), которое само имеет какую-то мощность, и таким образом опосредованно входит в себя.

В рамках теорий иерархических множеств о них вообще невозможно рассуждать — там по определению речь только о множествах, не содержащих себя ни прямо,
ни опосредованно. Кроме NF вообще не существует никаких известных способах вообще “думать” о предельных автореферрентных структурах.

Без NF парадоксы Кантора и Бурали-Форти (про множество кардиналов и ординалов) можно обсуждать только “по-философски”, как древние греки объясняли действие
всасывающих насосов тем, что природа боится пустоты или другими умозрительными принципами. А с NF мы можем в каком-то смысле “обнаружить атмосферное давление”.

В NF оказывается, что диагональный метод Кантора работает не всегда, т.к. в ходе доказательства используется нестратифицируемое свойство. И соответственно там
могут быть неканторианские “множества”, мощность которых не увеличивается когда мы строим множество всех их подмножеств. Таково множество всех множеств — оно
само себе множество всех своих подмножеств.

Там мы действительно можем определить “множество” всех кардиналов и обнаружить что его собственная мощность — предельный кардинал. И это но это не вызывает
противоречия потому что оно, разумеется, тоже неканторианское.

А парадокс Бурали-Форти разрешается в некотором смысле “в другую сторону”, “множество” всех ординалов является само по себе ординалом, но не предельным —
над ним ещё сколько угодно.
