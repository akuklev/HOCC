Годовщине изгнания из рая посвещается
=====================================

Два месяца назад, в апреле этого года завершился 87-летняя одиссея — поставлена точка в вопросе непротиворечивости системы математических оснований
NF (New Foundations), предложенной в 1937 философом и математиком Уиллардом Куайном в работе «New Foundations for Mathematical Logic».
Существующее уже 14 лет предполагаемое доказательство непротиворечивости было формализовано и верифицировано в [Lean](https://lean-lang.org/).

# Аксиоматические теории

Около 300 года до н.э. греческий философ и математик Евклид написал монографию «Начала» (Στοιχεῖα), где он демонстрирует на огромном количестве примеров,
что всевозможные свойства геометрических фигур, выводимы при помощи законов логики из небольшого набора постулатов (“аксиом”).
Так родилось понятие аксиоматической теории.

Евклидова геометрия — многосортная аксиоматическая теория: чтобы сформулировать постулаты, необходимо упоминать как минимум три разновидности сущностей —
точки, линии и длины. Иногда недостаточно иметь просто несколько разновидностей сущностей — требуются сущности “высшего порядка”, например кроме “точек”
ещё “конечные наборы точек” или кроме “чисел” ещё “функции на числах”. Многие другие аксиоматические теории наоборот односортные, например арифметика —
её постулаты можно сформулировать, упоминая лишь одну разновидность сущностей: числа.

Все математические области взаимосвязаны, и чтобы заниматься математикой в комплексе нужно какое-то общее основание, базовая “аксиоматическая теория
математических кирпичей”, в которую отображаются отдельные аксиоматические теории вроде геометрии Евклида и арифметики Пеано.

# Наивная теория множеств

В конце XIX века Готтлоб Фреге предложил использовать в этом качестве, в качестве общематематической базы, односортную аксиоматическую теорию, где
everything is a set.

Понятие “множества” в математике начали изучать более чем за полвека до этого, в 1830е годы. Когда аудиторию впервые знакомят с эти понятием, множества
обычно изображают как кружочки, содержащие которых буквы, цифры или точки. Их элементы — не другие множества, а некие “первичные элементы” —
абстрактные различимые объекты, лишенные внутренней структуры. Такие множества ещё называются неупорядоченными наборами без повторений, и являются одним
из распространённых типов комбинаторных стуктур наряду с упорядоченными наборами, неупорядоченными наборами с повторениями и т.д.

Теория множеств, предложенная Фреге, не про них. Фреге не ставил перед собой задачу создать аксиоматическую теорию “неупорядоченных наборов без
повторений”. Множества вообще не особенно интересовали его, он изучал логику и изучая её наткнулся на объекты, поверхностно напоминающие
неупорядоченные наборы без повторений, но только содержащие не какие-то “первичные элементы” без внутренней структуры, а другие множества.
Ведь теория множеств односортна и everything is a set, а стало быть все элементы множеств Фреге тоже в свою очередь множества Фреге.
Предмет изучения теории множеств (не только исходной теории множеств Фреге, но и всех последующих теорий множеств, предназначенных для использования
в качестве общематематической базы) — абстрактные вложенные множества. К ним, в частности, относится пустое множество ∅, множество {∅} содержащее пустое
множество и только его, а также множество {∅, {∅}}, элементами которого являются два приведённых прежде множества.
Зачем же использовать теорию столь странных объектов в качестве основания математики?

А дело тут вот в чём: в отличие от других аксиоматических теорий, таких как геометрия Евклида и арифметика Пеано, теория множеств Фреге описывает сущности,
неотъемлимо присущие самой логике: множества Фреге это в точности объектификация логических предикатов. Теория множеств Фреге не аппелирует ни к какой внешней
предметной области для обоснования своих постулатов: не считая законов логики, её единственным постулатом является принцип абстракции Фреге:
  **всякое свойство (т.е. всякий логический предикат) определяет, и притом однозначно, множество всех элементов, обладающих этим свойством.**

Теория Фреге предлагалась в качестве общематематической базы вовсе не потому, что “неупорядоченные наборы без повторений” какое-то особенное понятие, а потому
что множества Фреге (абстрактные вложенные множества, сделанные “из воздуха”, из вакуума пустых множеств) взаимно-однозначно соответствуют логическим предикатам
над самими собой, и оказывается что эта авторефлексивная кострукция даёт достаточно структуры, чтобы можно было отображать в неё другие аксиоматические
теории: определив при помощи принципа абстракции множества ∅, {∅}, {∅, {∅}}, {∅, {∅}, {∅, {∅}}}, ... мы получаем возможность моделлировать натуральные числа
и множества натуральных чисел, а уж при помощи последних можно начинать моделировать практически любые математические сущности.

Это был философски-математический рай.

Но очень недолго. До тех пор, пока ровно 122 года назад, 16.06.1902, Бертран Рассел написал Готтлобу Фреге письмо по поводу его монографии
Grundgesetze der Arithmetik: “there is just one point where I have encountered a difficulty.”

Если принять принцип Фреге, получается что существует множество {x | x ∉ x} всех множеств, не содержащих самих себя. Но если оно существует, то
принадлежит ли оно само себе? На этот вопрос невозможен ни положительный, ни отрицательный ответ (это назвается парадоксом Рассела), так что не
может такое множество существовать.

Наивная теория множеств оказалась несостоятельной, а математика вошла в глубокий кризис, полностью её перепахавший и веведший на другой уровень.

Этот, оказавшийся недопустимым, принцип абстракции Фреге позже назвали неограниченным принципом абстракции, потому что чтобы избежать противоречий,
его нужно тем или иным способом ограничить чтобы из него не следовало существование паталогических автореферрентных объектов типа {x | x ∉ x}.

Когда нужно что-то ограничить, всегда есть два крайних подхода — знаете, как с пищевыми добавками в США и в Европе. В США разрешено всё кроме
заведомо ядовитого. В ЕС запрещено всё, что не имеет доказанной безвредности.

Обжегшись на неограниченном принципе свёртывания математики начала XX века в основном пошли по второму пути: стали рассматривать только множества,
которые можно построить начиная с пустого множества “снизу вверх”, иерархические множества.

Стандартная теория множеств ZF(C) рассматривает только иерархические множества. Вполне допустимые с точки зрения наивной теории множества, допускающие
бесконечные цепочки a ∋ b ∋ c ∋ ··· такими теориями не рассматриваются в принципе, чтобы не дай бог не напороться на паталогические автореферрентные множества.

Попытка пойти по пути ”запретить только заведомо ядовитое“ — система NF, разработанная в 1937 философом и математиком Уиллардом Куайном. Название происходит от
названия статьи New Foundations for Mathematical Logic, где эта система описывается. Как и наивная теория множеств, эта система состоит из логики предикатов с 
экстенциональным равенством и одной единственной схемой аксиом — принципом абстракции, но уже ограниченным синтаксически: всякое свойство, описуемое
стратифицируемой логической формулой, определяет множество множеств, обладающих этим свойством. Тут стратифицируемость — некое синтаксической свойство
формулы (не буду вдаваться в технические подробности), защищающее от паталогических автореферрентных множеств.

На практике NF оказалась не такой уж удобной штукой, но очень интересной философски.

В частности, количественные числа (кардиналы) там можно определить как завещал Фреге — как классы эквивалентности множеств по взаимно-однозначной сопостовляемости.
В ZF приходится проявлять произвол и выбирать какой-то конкретный (один из нескольких естественных) способов кодирования натуральных чисел множествами, а в NF это
просто кардинал “2” это совокупность всех двухэлементных множеств, и это канонический выбор.

NF — уникальная система оснований математики, допускающая предельные структуры, содержащие сами себя:
- множество всех множеств,
- множеств всех ординалов,
- категорию всех категорий.

Но чтобы математики всерьёз занимались NF, было необходимо было показать её непротиворечивость относительно стаднартной теории множеств. На протяжении более чем
80 лет это ни у кого не получалось. Потом Randall Holmes выложил препринт такого доказательства. Только никто не был готов делать peer review этой статьи.
Сам же автор во введении употребляет фразу ‘insanely involved with nasty bookkeeping’ (безумно насыщено монструозной бухгалтерией) в отношении своего доказательства.
И вот вместо того чтобы ждать пока кто-то снизойдёт до проверки этого монстуруозного доказательства, они с аспирантом Sky Wilshaw взяли и формализовали доказательство, так что его проверил компьютер.
https://www.logicmatters.net/.../21/nf-really-is-consistent/

* * *

В заключение я ещё скажу пару слов про то, почему NF не особенно удобна на практике. Всё дело в том, примерно все практические применения теории множеств
используют не гигантические всеобъемлющие структуры, в как раз-таки иерархические множества. При работе с такими множествами стратифицируемость формул при
использовании принципа абстракции не требуется и очень мешает.

Что мешает — это понятно сразу как попробуешь хоть немного практически поработать в рамках NF, а вот что “не требуется” — этого, конечно, изначально тоже
никто не знал.  В 1956 году Вильгельм Аккерман предложил свой вариант теории множеств (AST), где область рассмотрения не ограничивается только иерархическими
множествами, а принцип абстракци тоже ограничивается по либеральной схеме ”запретить только заведомо ядовитое“, но совсем по-другому чем в NF.

В теории Аккермана постулируется константа V — множество иерархических множеств (само по себе не являющееся иерархическим), а принцип абстракции разбивается на
два аспекта — выделение и рефлексия.

Выделение {x ∈ V | φ(x)} позволяет безо всяких ограничений на предикат φ строить подмножества V, удовлетворяющие этому предикату. Т.е. для любого предиката φ
существует множество иерархических, удовлетворяющих этому предикату.

Рефлексия же постулирует, что всякий предикат, кванторы в котором могут быть ограничены на V без изменения смысла, определяет множество (не обязательно иерархическое):
 φ ⇔ φᵛ
––—––––
{x | φ(x)}

AST является расширением ZF в том смысле, что её язык позволяет говорить не только об иерархических множествах, как ZF, но и о множестве V (всех иерархических множеств)
или Ord (всех иерархических ординалов), более того такие неиерархические множества могут быть элементами других множеств, что выгодно отличает эту теорию от
распостранённой теории NBG.

В 1970 году было показано, что эта теория является эквиконсистентным консервативным расширением ZF:
1) любое утверждение про иерархические множества доказуемо в AST тогда и только тогда, когда оно доказуемо в ZF;
2) из непротиворечивости ZF следует непротиворечивость AST и обратно.

Таким образом выходит что если ограничиваться иерархическими множествами, либеральный и минималистский подход совпадают.

Стоп! Так если в AST уже есть V и Ord, чем вообще хороша NF?! — А тем, что в AST ни V (всех иерархических множеств), ни Ord (всех иерархических ординалов),
не содержат сами себя — они ведь не являются сами иерархическими, избегая таким образом автореферрентности.
В то время как в NF возможны “настоящие” всеобъемлющие структуры.
